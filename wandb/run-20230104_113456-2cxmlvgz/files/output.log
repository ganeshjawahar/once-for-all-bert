Subnet info: Model-Size=59898492, Val-PPL=6.142744418431955
Subnet info: Gene=[564, 12, 1974]
Subnet info: Search_space_id=v5.1
Subnet info: elastic_keys= []
Subnet info: gene_choices= []
Subnet info: gene_names= []
Subnet info: elastickey2ranges= {}
BertConfig {
  "_name_or_path": "/fsx/ganayu/experiments/supershaper/dec15_neuronrouting_v5p1/5p1/best_model",
  "additional_random_softmaxing": false,
  "alpha_divergence": 0,
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bottleneck_rank": 50,
  "classifier_dropout": null,
  "expert_routing_type": "neuronrouting_jack_2L",
  "fixed_hypernet_input": "no",
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0,
  "hidden_size": 768,
  "hypernet_hidden_size": 128,
  "hypernet_input_format": "standard",
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "last_expert_averaging_expert": "no",
  "layer_drop_prob": 0.0,
  "layer_norm_eps": 1e-12,
  "max_experts": 2,
  "max_position_embeddings": 512,
  "max_seq_length": 128,
  "mixing": "attention",
  "model_type": "bert",
  "normalization_type": "layer_norm",
  "num_attention_heads": 12,
  "num_feedforward_networks": 1,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "random_layer_selection_probability": 0.1,
  "rewire": 0,
  "sample_expert_ids": [
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0
  ],
  "sample_hidden_size": 564,
  "sample_intermediate_size": [
    1974,
    1974,
    1974,
    1974,
    1974,
    1974,
    1974,
    1974,
    1974,
    1974,
    1974,
    1974
  ],
  "sample_num_attention_heads": [
    12,
    12,
    12,
    12,
    12,
    12,
    12,
    12,
    12,
    12,
    12,
    12
  ],
  "sample_num_hidden_layers": 12,
  "search_space_id": "v5.1",
  "transformers_version": "4.11.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "use_hypernet_w_low_rank": 0,
  "vocab_size": 30522
}
pre-initialized with BERT weights
/data/home/ganayu/miniconda/envs/basic/lib/python3.8/site-packages/transformers/configuration_utils.py:336: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
01/04/2023 11:35:04 - INFO - __main__ -   ==================================================================
01/04/2023 11:35:04 - INFO - __main__ -   Number of parameters in custom config is 109 Million
01/04/2023 11:35:04 - INFO - __main__ -   ==================================================================
Traceback (most recent call last):
  File "train_mlm.py", line 2428, in <module>
    main()
  File "train_mlm.py", line 1404, in main
    model = custom_bert.BertForMaskedLM.from_pretrained(args.model_name_or_path, config=global_config)
  File "/data/home/ganayu/miniconda/envs/basic/lib/python3.8/site-packages/transformers/modeling_utils.py", line 1385, in from_pretrained
    model = cls(config, *model_args, **model_kwargs)
  File "/fsx/ganayu/code/SuperShaper/custom_layers/custom_bert.py", line 2790, in __init__
    self.bert = BertModel(config, add_pooling_layer=False)
  File "/fsx/ganayu/code/SuperShaper/custom_layers/custom_bert.py", line 2279, in __init__
    self.encoder = BertEncoder(config)
  File "/fsx/ganayu/code/SuperShaper/custom_layers/custom_bert.py", line 1795, in __init__
    [layer_function(config) for _ in range(config.sample_num_hidden_layers)] # changed to sample_num_hidden_layers (finetuning bug)
  File "/fsx/ganayu/code/SuperShaper/custom_layers/custom_bert.py", line 1795, in <listcomp>
    [layer_function(config) for _ in range(config.sample_num_hidden_layers)] # changed to sample_num_hidden_layers (finetuning bug)
  File "/fsx/ganayu/code/SuperShaper/custom_layers/custom_bert.py", line 1456, in __init__
    elif config.search_space_id.startswith("v5."):
AttributeError: 'NoneType' object has no attribute 'startswith'